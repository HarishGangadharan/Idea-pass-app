"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactBootstrapTable2Filter = require("react-bootstrap-table2-filter");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var Column =
/**
 * Transform object to Column
 */
function Column() {
  var _this = this;

  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
      _key = _ref.key,
      _label = _ref.label,
      isActionColumn = _ref.isActionColumn,
      _isHidden = _ref.isHidden,
      _searchKey = _ref.searchKey,
      cellFormatter = _ref.cellFormatter,
      _unit = _ref.unit,
      sortable = _ref.sortable,
      _rowClass = _ref.rowClass,
      _onClick = _ref.onClick,
      _align = _ref.align,
      _headerFormatter = _ref.headerFormatter,
      _headerClass = _ref.headerClass,
      _type = _ref.type,
      _filterConfig = _ref.filterConfig,
      isFilterable = _ref.isFilterable;

  _classCallCheck(this, Column);

  _defineProperty(this, "isHidden", void 0);

  _defineProperty(this, "searchKey", void 0);

  _defineProperty(this, "type", void 0);

  _defineProperty(this, "key", void 0);

  _defineProperty(this, "label", void 0);

  _defineProperty(this, "isActionColumn", void 0);

  _defineProperty(this, "cellFormatter", void 0);

  _defineProperty(this, "unit", void 0);

  _defineProperty(this, "sortable", void 0);

  _defineProperty(this, "rowClass", void 0);

  _defineProperty(this, "onClick", void 0);

  _defineProperty(this, "align", void 0);

  _defineProperty(this, "headerFormatter", void 0);

  _defineProperty(this, "headerClass", void 0);

  _defineProperty(this, "filterConfig", void 0);

  _defineProperty(this, "isFilterable", void 0);

  _defineProperty(this, "withKey", function (key) {
    _this.key = key;
    _this.searchKey = key;
    return _this;
  });

  _defineProperty(this, "withLabel", function (label) {
    _this.label = label;
    return _this;
  });

  _defineProperty(this, "getKey", function () {
    return _this.key;
  });

  _defineProperty(this, "getLabel", function () {
    return _this.label;
  });

  _defineProperty(this, "enableFilter", function () {
    _this.isFilterable = true;
    return _this;
  });

  _defineProperty(this, "ofType", function (type) {
    _this.type = type;
    return _this;
  });

  _defineProperty(this, "asActionColumn", function () {
    _this.isActionColumn = true;
    return _this;
  });

  _defineProperty(this, "markAsHidden", function (isHidden) {
    _this.isHidden = isHidden;
    return _this;
  });

  _defineProperty(this, "withCellFormatter", function (cellformatter) {
    _this.cellFormatter = cellformatter;
    return _this;
  });

  _defineProperty(this, "withUnit", function (unit) {
    _this.unit = unit;
    return _this;
  });

  _defineProperty(this, "asSortable", function () {
    _this.sortable = true;
    return _this;
  });

  _defineProperty(this, "withRowClass", function (rowClass) {
    _this.rowClass = rowClass;
    return _this;
  });

  _defineProperty(this, "withClickHandler", function (onClick) {
    _this.onClick = onClick;
    return _this;
  });

  _defineProperty(this, "withAlign", function (align) {
    _this.align = align;
    return _this;
  });

  _defineProperty(this, "withHeaderFormatter", function (headerFormatter) {
    _this.headerFormatter = headerFormatter;
    return _this;
  });

  _defineProperty(this, "withHeaderClass", function (headerClass) {
    _this.headerClass = headerClass;
    return _this;
  });

  _defineProperty(this, "withFilterConfig", function (filterConfig) {
    _this.filterConfig = filterConfig;
    return _this;
  });

  _defineProperty(this, "withSearchKey", function (searchKey) {
    _this.searchKey = searchKey;
    return _this;
  });

  _defineProperty(this, "getFilterForType", function () {
    if (_this.type === Column.COLUMN_TYPES.TEXT) {
      return (0, _reactBootstrapTable2Filter.textFilter)(_this.filterConfig);
    } else if (_this.type === Column.COLUMN_TYPES.NUMBER) {
      return (0, _reactBootstrapTable2Filter.numberFilter)(_this.filterConfig);
    } else if (_this.type === Column.COLUMN_TYPES.DATE) {
      return (0, _reactBootstrapTable2Filter.dateFilter)(_this.filterConfig);
    } else if (_this.type === Column.COLUMN_TYPES.SELECT) {
      return (0, _reactBootstrapTable2Filter.selectFilter)(_this.filterConfig);
    }

    return null;
  });

  _defineProperty(this, "convertToBootstrapTableColumn", function () {
    var defaultColumn = {
      align: _this.align,
      classes: _this.rowClass,
      csvExport: !_this.isHidden,
      dataField: _this.key,
      events: {
        onClick: _this.onClick
      },
      formatExtraData: _this.unit,
      formatter: _this.cellFormatter,
      headerAlign: _this.align,
      headerClasses: _this.headerClass,
      headerEvents: {
        onClick: _this.onClick
      },
      headerFormatter: _this.headerFormatter,
      hidden: _this.isHidden,
      isDummyField: _this.isActionColumn,
      searchKey: _this.searchKey,
      sort: _this.sortable,
      text: _this.label,
      type: _this.type
    };

    if (_this.isFilterable && _this.type !== Column.COLUMN_TYPES.NONE) {
      defaultColumn = Object.assign({}, defaultColumn, {
        filter: _this.getFilterForType()
      });
    }

    return defaultColumn;
  });

  this.key = _key || '';
  this.label = _label || '';
  this.isActionColumn = isActionColumn || false;
  this.isHidden = _isHidden || false;
  this.searchKey = _searchKey || '';
  this.cellFormatter = cellFormatter ? cellFormatter : function (cell, row, rowIndex, formatExtraData) {
    return cell;
  };
  this.unit = _unit || '';
  this.sortable = sortable || false;
  this.rowClass = _rowClass || '';
  this.onClick = _onClick ? _onClick : function (e) {
    e.preventDefault();
  };
  this.align = _align || 'left';
  this.headerFormatter = _headerFormatter ? _headerFormatter : function (column, colIndex, components) {
    return React.createElement("div", null, column.text, components.sortElement, components.filterElement);
  };
  this.headerClass = _headerClass || '';
  this.type = _type || Column.COLUMN_TYPES.NONE;
  this.filterConfig = _filterConfig || {};
  this.isFilterable = isFilterable || false;
}
/**
 * Add data identifier (i.e dataField) to Column
 * NOTE: Mandatory
 * @param key
 */
;

exports.default = Column;

_defineProperty(Column, "COLUMN_TYPES", {
  DATE: 'DATE',
  NONE: 'NONE',
  NUMBER: 'NUMBER',
  SELECT: 'SELECT',
  TEXT: 'TEXT'
});

_defineProperty(Column, "convertObjectToColumn", function (col) {
  var columnDef = new Column().withKey(col.key).withLabel(col.name);

  if (col.enableSort) {
    columnDef.asSortable();
  }

  if (col.type) {
    if (col.filterable) {
      columnDef.enableFilter();
    }

    columnDef.ofType(col.type);

    if (col.type === Column.COLUMN_TYPES.SELECT) {
      var options = col.options;

      if (col.textField && col.valueField) {
        options = col.options.reduce(function (accumulator, option) {
          return Object.assign({}, accumulator, _defineProperty({}, option[col.valueField], option[col.textField]));
        }, {});
      }

      columnDef.withFilterConfig({
        options: options
      });
    }
  }

  return columnDef;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1RhYmxlL0NvbHVtbi50c3giXSwibmFtZXMiOlsiQ29sdW1uIiwia2V5IiwibGFiZWwiLCJpc0FjdGlvbkNvbHVtbiIsImlzSGlkZGVuIiwic2VhcmNoS2V5IiwiY2VsbEZvcm1hdHRlciIsInVuaXQiLCJzb3J0YWJsZSIsInJvd0NsYXNzIiwib25DbGljayIsImFsaWduIiwiaGVhZGVyRm9ybWF0dGVyIiwiaGVhZGVyQ2xhc3MiLCJ0eXBlIiwiZmlsdGVyQ29uZmlnIiwiaXNGaWx0ZXJhYmxlIiwiY2VsbGZvcm1hdHRlciIsIkNPTFVNTl9UWVBFUyIsIlRFWFQiLCJOVU1CRVIiLCJEQVRFIiwiU0VMRUNUIiwiZGVmYXVsdENvbHVtbiIsImNsYXNzZXMiLCJjc3ZFeHBvcnQiLCJkYXRhRmllbGQiLCJldmVudHMiLCJmb3JtYXRFeHRyYURhdGEiLCJmb3JtYXR0ZXIiLCJoZWFkZXJBbGlnbiIsImhlYWRlckNsYXNzZXMiLCJoZWFkZXJFdmVudHMiLCJoaWRkZW4iLCJpc0R1bW15RmllbGQiLCJzb3J0IiwidGV4dCIsIk5PTkUiLCJPYmplY3QiLCJhc3NpZ24iLCJmaWx0ZXIiLCJnZXRGaWx0ZXJGb3JUeXBlIiwiY2VsbCIsInJvdyIsInJvd0luZGV4IiwiZSIsInByZXZlbnREZWZhdWx0IiwiY29sdW1uIiwiY29sSW5kZXgiLCJjb21wb25lbnRzIiwic29ydEVsZW1lbnQiLCJmaWx0ZXJFbGVtZW50IiwiY29sIiwiY29sdW1uRGVmIiwid2l0aEtleSIsIndpdGhMYWJlbCIsIm5hbWUiLCJlbmFibGVTb3J0IiwiYXNTb3J0YWJsZSIsImZpbHRlcmFibGUiLCJlbmFibGVGaWx0ZXIiLCJvZlR5cGUiLCJvcHRpb25zIiwidGV4dEZpZWxkIiwidmFsdWVGaWVsZCIsInJlZHVjZSIsImFjY3VtdWxhdG9yIiwib3B0aW9uIiwid2l0aEZpbHRlckNvbmZpZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7Ozs7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QyxHQUFHLENBQUN0QyxJQUFKLEtBQWFkLE1BQU0sQ0FBQ2tCLFlBQVAsQ0FBb0JJLE1BQXJDLEVBQTZDO0FBQzNDLFVBQUl3QyxPQUFPLEdBQUdWLEdBQUcsQ0FBQ1UsT0FBbEI7O0FBQ0EsVUFBSVYsR0FBRyxDQUFDVyxTQUFKLElBQWlCWCxHQUFHLENBQUNZLFVBQXpCLEVBQXFDO0FBQ25DRixRQUFBQSxPQUFPLEdBQUdWLEdBQUcsQ0FBQ1UsT0FBSixDQUFZRyxNQUFaLENBQW1CLFVBQUNDLFdBQUQsRUFBc0JDLE1BQXRCLEVBQXNDO0FBQ2pFLGlCQUFPN0IsTUFBTSxDQUFDQyxNQUFQLENBQWMsRUFBZCxFQUFrQjJCLFdBQWxCLHNCQUVKQyxNQUFNLENBQUNmLEdBQUcsQ0FBQ1ksVUFBTCxDQUZGLEVBRXFCRyxNQUFNLENBQUNmLEdBQUcsQ0FBQ1csU0FBTCxDQUYzQixFQUFQO0FBSUQsU0FMUyxFQUtQLEVBTE8sQ0FBVjtBQU1EOztBQUNEVixNQUFBQSxTQUFTLENBQUNlLGdCQUFWLENBQTJCO0FBQ3pCTixRQUFBQSxPQUFPLEVBQVBBO0FBRHlCLE9BQTNCO0FBR0Q7QUFDRjs7QUFDRCxTQUFPVCxTQUFQO0FBQ0QsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGRhdGVGaWx0ZXIsIG51bWJlckZpbHRlciwgc2VsZWN0RmlsdGVyLCB0ZXh0RmlsdGVyIH0gZnJvbSAncmVhY3QtYm9vdHN0cmFwLXRhYmxlMi1maWx0ZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElIZWFkZXJDb21wb25lbnQge1xuICBzb3J0RWxlbWVudDogYW55LFxuICBmaWx0ZXJFbGVtZW50OiBhbnlcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJQm9vdHN0cmFwQ29sdW1uIHtcbiAgZGF0YUZpZWxkOiBzdHJpbmcsXG4gIHRleHQ6IHN0cmluZyxcbiAgaXNEdW1teUZpZWxkOiBib29sZWFuLFxuICBoaWRkZW46IGJvb2xlYW4sXG4gIGZvcm1hdHRlcjogYW55LFxuICBmb3JtYXRFeHRyYURhdGE6IGFueSxcbiAgc29ydDogYm9vbGVhbixcbiAgY2xhc3NlczogYW55LFxuICBldmVudHM6IG9iamVjdCxcbiAgYWxpZ246IGFueSxcbiAgaGVhZGVyRm9ybWF0dGVyOiBhbnksXG4gIGhlYWRlckNsYXNzZXM6IGFueSxcbiAgaGVhZGVyRXZlbnRzOiBhbnksXG4gIGhlYWRlckFsaWduOiBhbnksXG4gIGNzdkV4cG9ydDogYm9vbGVhbixcbiAgc2VhcmNoS2V5OiBzdHJpbmcsXG4gIHR5cGU6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDb2xEZWYge1xuICBrZXk6IHN0cmluZyxcbiAgbmFtZTogc3RyaW5nLFxuICBmaWx0ZXJhYmxlPzogYm9vbGVhbixcbiAgZW5hYmxlU29ydD86IGJvb2xlYW4sXG4gIHR5cGU/OiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBhbnksXG4gIHZhbHVlRmllbGQ/OiBzdHJpbmcsXG4gIHRleHRGaWVsZD86IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDb2x1bW5Qcm9wcyB7XG4gIGlzSGlkZGVuPzogYm9vbGVhbixcbiAgc2VhcmNoS2V5Pzogc3RyaW5nLFxuICB0eXBlPzogc3RyaW5nLFxuICBrZXk/OiBzdHJpbmcsXG4gIGxhYmVsPzogc3RyaW5nLFxuICBpc0FjdGlvbkNvbHVtbj86IGJvb2xlYW4sXG4gIGNlbGxGb3JtYXR0ZXI/OiBhbnksXG4gIHVuaXQ/OiBhbnksXG4gIHNvcnRhYmxlPzogYm9vbGVhbixcbiAgcm93Q2xhc3M/OiBhbnksXG4gIG9uQ2xpY2s/OiBhbnksXG4gIGFsaWduPzogYW55LFxuICBoZWFkZXJGb3JtYXR0ZXI/OiBhbnksXG4gIGhlYWRlckNsYXNzPzogYW55LFxuICBmaWx0ZXJDb25maWc/OiBvYmplY3QsXG4gIGlzRmlsdGVyYWJsZT86IGJvb2xlYW4sXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbHVtbiB7XG4gIHB1YmxpYyBzdGF0aWMgQ09MVU1OX1RZUEVTID0ge1xuICAgIERBVEU6ICdEQVRFJyxcbiAgICBOT05FOiAnTk9ORScsXG4gICAgTlVNQkVSOiAnTlVNQkVSJyxcbiAgICBTRUxFQ1Q6ICdTRUxFQ1QnLFxuICAgIFRFWFQ6ICdURVhUJ1xuICB9O1xuICAvKipcbiAgICogVHJhbnNmb3JtIG9iamVjdCB0byBDb2x1bW5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY29udmVydE9iamVjdFRvQ29sdW1uID0gKGNvbDogSUNvbERlZik6IENvbHVtbiA9PiB7XG4gICAgY29uc3QgY29sdW1uRGVmOiBDb2x1bW4gPSAgbmV3IENvbHVtbigpLndpdGhLZXkoY29sLmtleSkud2l0aExhYmVsKGNvbC5uYW1lKTtcbiAgICBpZiAoY29sLmVuYWJsZVNvcnQpIHtcbiAgICAgIGNvbHVtbkRlZi5hc1NvcnRhYmxlKCk7XG4gICAgfVxuICAgIGlmIChjb2wudHlwZSkge1xuICAgICAgaWYgKGNvbC5maWx0ZXJhYmxlKSB7XG4gICAgICAgIGNvbHVtbkRlZi5lbmFibGVGaWx0ZXIoKTtcbiAgICAgIH1cbiAgICAgIGNvbHVtbkRlZi5vZlR5cGUoY29sLnR5cGUpO1xuICAgICAgaWYgKGNvbC50eXBlID09PSBDb2x1bW4uQ09MVU1OX1RZUEVTLlNFTEVDVCkge1xuICAgICAgICBsZXQgb3B0aW9ucyA9IGNvbC5vcHRpb25zO1xuICAgICAgICBpZiAoY29sLnRleHRGaWVsZCAmJiBjb2wudmFsdWVGaWVsZCkge1xuICAgICAgICAgIG9wdGlvbnMgPSBjb2wub3B0aW9ucy5yZWR1Y2UoKGFjY3VtdWxhdG9yOiBvYmplY3QsIG9wdGlvbjogYW55KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgYWNjdW11bGF0b3IsIHtcbiAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICBbb3B0aW9uW2NvbC52YWx1ZUZpZWxkXV06IG9wdGlvbltjb2wudGV4dEZpZWxkXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSwge30pO1xuICAgICAgICB9XG4gICAgICAgIGNvbHVtbkRlZi53aXRoRmlsdGVyQ29uZmlnKHtcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29sdW1uRGVmO1xuICB9XG5cbiAgcHVibGljIGlzSGlkZGVuOiBib29sZWFuO1xuICBwdWJsaWMgc2VhcmNoS2V5OiBzdHJpbmc7XG4gIHB1YmxpYyB0eXBlOiBzdHJpbmc7XG4gIHByaXZhdGUga2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgbGFiZWw6IHN0cmluZztcbiAgcHJpdmF0ZSBpc0FjdGlvbkNvbHVtbjogYm9vbGVhbjtcbiAgcHJpdmF0ZSBjZWxsRm9ybWF0dGVyOiBhbnk7XG4gIHByaXZhdGUgdW5pdDogYW55O1xuICBwcml2YXRlIHNvcnRhYmxlOiBib29sZWFuO1xuICBwcml2YXRlIHJvd0NsYXNzOiBhbnk7XG4gIHByaXZhdGUgb25DbGljazogYW55O1xuICBwcml2YXRlIGFsaWduOiBhbnk7XG4gIHByaXZhdGUgaGVhZGVyRm9ybWF0dGVyOiBhbnk7XG4gIHByaXZhdGUgaGVhZGVyQ2xhc3M6IGFueTtcbiAgcHJpdmF0ZSBmaWx0ZXJDb25maWc6IG9iamVjdDtcbiAgcHJpdmF0ZSBpc0ZpbHRlcmFibGU6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIGtleSxcbiAgICBsYWJlbCxcbiAgICBpc0FjdGlvbkNvbHVtbixcbiAgICBpc0hpZGRlbixcbiAgICBzZWFyY2hLZXksXG4gICAgY2VsbEZvcm1hdHRlcixcbiAgICB1bml0LFxuICAgIHNvcnRhYmxlLFxuICAgIHJvd0NsYXNzLFxuICAgIG9uQ2xpY2ssXG4gICAgYWxpZ24sXG4gICAgaGVhZGVyRm9ybWF0dGVyLFxuICAgIGhlYWRlckNsYXNzLFxuICAgIHR5cGUsXG4gICAgZmlsdGVyQ29uZmlnLFxuICAgIGlzRmlsdGVyYWJsZVxuICB9IDogSUNvbHVtblByb3BzID0ge30gYXMgSUNvbHVtblByb3BzKSB7XG4gICAgdGhpcy5rZXkgPSBrZXkgfHwgICcnO1xuICAgIHRoaXMubGFiZWwgPSBsYWJlbCB8fCAgJyc7XG4gICAgdGhpcy5pc0FjdGlvbkNvbHVtbiA9IGlzQWN0aW9uQ29sdW1uIHx8ICBmYWxzZTtcbiAgICB0aGlzLmlzSGlkZGVuID0gaXNIaWRkZW4gfHwgIGZhbHNlO1xuICAgIHRoaXMuc2VhcmNoS2V5ID0gc2VhcmNoS2V5IHx8ICAnJztcbiAgICB0aGlzLmNlbGxGb3JtYXR0ZXIgPSBjZWxsRm9ybWF0dGVyID8gY2VsbEZvcm1hdHRlciA6IChjZWxsOiBhbnksIHJvdzogb2JqZWN0LCByb3dJbmRleDogbnVtYmVyLCBmb3JtYXRFeHRyYURhdGE6IGFueSkgOiBhbnkgPT4gY2VsbDtcbiAgICB0aGlzLnVuaXQgPSB1bml0IHx8ICAnJztcbiAgICB0aGlzLnNvcnRhYmxlID0gc29ydGFibGUgfHwgIGZhbHNlO1xuICAgIHRoaXMucm93Q2xhc3MgPSByb3dDbGFzcyB8fCAgJyc7XG4gICAgdGhpcy5vbkNsaWNrID0gb25DbGljayA/IG9uQ2xpY2sgOiAoZTogYW55ICkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gICAgdGhpcy5hbGlnbiA9IGFsaWduIHx8ICAnbGVmdCc7XG4gICAgdGhpcy5oZWFkZXJGb3JtYXR0ZXIgPSBoZWFkZXJGb3JtYXR0ZXIgPyBoZWFkZXJGb3JtYXR0ZXIgOiAoY29sdW1uIDogSUJvb3RzdHJhcENvbHVtbiwgY29sSW5kZXggOiBudW1iZXIsIGNvbXBvbmVudHMgOiBJSGVhZGVyQ29tcG9uZW50ICkgOiBhbnkgPT4gKFxuICAgICAgPGRpdj5cbiAgICAgICAge2NvbHVtbi50ZXh0fVxuICAgICAgICB7Y29tcG9uZW50cy5zb3J0RWxlbWVudH1cbiAgICAgICAge2NvbXBvbmVudHMuZmlsdGVyRWxlbWVudH1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gICAgdGhpcy5oZWFkZXJDbGFzcyA9IGhlYWRlckNsYXNzIHx8ICAnJztcbiAgICB0aGlzLnR5cGUgPSB0eXBlIHx8ICBDb2x1bW4uQ09MVU1OX1RZUEVTLk5PTkU7XG4gICAgdGhpcy5maWx0ZXJDb25maWcgPSBmaWx0ZXJDb25maWcgfHwgIHt9O1xuICAgIHRoaXMuaXNGaWx0ZXJhYmxlID0gaXNGaWx0ZXJhYmxlIHx8ICBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgZGF0YSBpZGVudGlmaWVyIChpLmUgZGF0YUZpZWxkKSB0byBDb2x1bW5cbiAgICogTk9URTogTWFuZGF0b3J5XG4gICAqIEBwYXJhbSBrZXlcbiAgICovXG4gIHB1YmxpYyB3aXRoS2V5ID0gKGtleTogc3RyaW5nKSA6IENvbHVtbiA9PiB7XG4gICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgdGhpcy5zZWFyY2hLZXkgPSBrZXk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxhYmVsIChpLmUgdGV4dCkgdG8gQ29sdW1uXG4gICAqIE5PVEU6IE1hbmRhdG9yeVxuICAgKiBAcGFyYW0gbGFiZWxcbiAgICovXG4gIHB1YmxpYyB3aXRoTGFiZWwgPSAobGFiZWw6IHN0cmluZykgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQga2V5IG9mIGNvbHVtblxuICAgKi9cbiAgcHVibGljIGdldEtleSA9ICgpIDogc3RyaW5nID0+IHRoaXMua2V5O1xuXG4gIC8qKlxuICAgKiBHZXQgTGFiZWwgb2YgY29sdW1uXG4gICAqL1xuICBwdWJsaWMgZ2V0TGFiZWwgPSAoKSA6IHN0cmluZyA9PiB0aGlzLmxhYmVsO1xuXG4gIC8qKlxuICAgKiBFbmFibGUgZmlsdGVyIHdpdGhpbmcgY29sdW1uXG4gICAqL1xuICBwdWJsaWMgZW5hYmxlRmlsdGVyID0gKCk6IENvbHVtbiA9PiB7XG4gICAgdGhpcy5pc0ZpbHRlcmFibGUgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBjb2x1bW4gdHlwZSB0byBhZGQgY29sdW1uIGZpbHRlciBiYXNlZCBvbiB0aGUgdHlwZVxuICAgKiBOT1RFIDogT3B0aW9uYWxcbiAgICogQHBhcmFtIHR5cGVcbiAgICovXG4gIHB1YmxpYyBvZlR5cGUgPSAodHlwZTogc3RyaW5nKSA6IENvbHVtbiA9PiB7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTcGVjaWZ5IGlmIGNvbHVtbiBoYXMgb25seSBhY3Rpb25zIChsaWtlIEVkaXQsIE1vcmUsIGV0YylcbiAgICogTk9URSA6IE9wdGlvbmFsXG4gICAqL1xuICBwdWJsaWMgYXNBY3Rpb25Db2x1bW4gPSAoKSA6IENvbHVtbiA9PiB7XG4gICAgdGhpcy5pc0FjdGlvbkNvbHVtbiA9IHRydWU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmeSB3aGV0aGVyIGNvbHVtbiBpcyBoaWRkZW4gb3Igc2hvd24gYm90aCBpbiBkaXNwbGF5IGFuZCBDU1ZcbiAgICogQE5PVEU6IE9wdGlvbmFsXG4gICAqIEBwYXJhbSBpc0hpZGRlblxuICAgKi9cbiAgcHVibGljIG1hcmtBc0hpZGRlbiA9IChpc0hpZGRlbjogYm9vbGVhbikgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMuaXNIaWRkZW4gPSBpc0hpZGRlbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgY2VsbCBmb3JtYXR0ZXIgdG8gY3VzdG9taXplIHRoZSBkaXNwbGF5IG9mIHRoZSBjb250ZW50XG4gICAqIFJlZmVyZW5jZTogaHR0cHM6Ly9yZWFjdC1ib290c3RyYXAtdGFibGUuZ2l0aHViLmlvL3JlYWN0LWJvb3RzdHJhcC10YWJsZTIvZG9jcy9iYXNpYy1jb2x1bW4uaHRtbFxuICAgKiBAcGFyYW0gY2VsbGZvcm1hdHRlclxuICAgKi9cbiAgcHVibGljIHdpdGhDZWxsRm9ybWF0dGVyID0gKGNlbGxmb3JtYXR0ZXI6IGFueSkgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMuY2VsbEZvcm1hdHRlciA9IGNlbGxmb3JtYXR0ZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGV4dHJhIGRhdGEgbGlrZSB1bml0IG9yIHN1ZmZpeCB0byBjZWxsIGNvbnRlbnQgKGkuZSBmb3JtYXRFeHRyYURhdGEpXG4gICAqIFJlZmVyZW5jZTogaHR0cHM6Ly9yZWFjdC1ib290c3RyYXAtdGFibGUuZ2l0aHViLmlvL3JlYWN0LWJvb3RzdHJhcC10YWJsZTIvZG9jcy9iYXNpYy1jb2x1bW4uaHRtbFxuICAgKiBAcGFyYW0gdW5pdFxuICAgKi9cbiAgcHVibGljIHdpdGhVbml0ID0gKHVuaXQ6IHN0cmluZykgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMudW5pdCA9IHVuaXQ7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmeSB3aGV0aGVyIGNvbHVtbiBpcyBzb3J0YWJsZSB0byBkaXNwbGF5IHNvcnQgb3B0aW9uc1xuICAgKiBOT1RFOiBTZXJ2ZXIgc2lkZSBzb3J0aW5nIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHRvIHJlZnJlc2ggdGhlIGRhdGFcbiAgICovXG4gIHB1YmxpYyBhc1NvcnRhYmxlID0gKCkgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMuc29ydGFibGUgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgYWRkaXRpb25hbCBjbGFzcyBmb3IgUm93XG4gICAqIFJlZmVyZW5jZTogaHR0cHM6Ly9yZWFjdC1ib290c3RyYXAtdGFibGUuZ2l0aHViLmlvL3JlYWN0LWJvb3RzdHJhcC10YWJsZTIvZG9jcy9iYXNpYy1yb3cuaHRtbFxuICAgKiBAcGFyYW0gcm93Q2xhc3NcbiAgICovXG4gIHB1YmxpYyB3aXRoUm93Q2xhc3MgPSAocm93Q2xhc3M6IGFueSkgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMucm93Q2xhc3MgPSByb3dDbGFzcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTcGVjaWZ5IGNhbGxiYWNrIGZvciByb3cgY2xpY2tcbiAgICogQHBhcmFtIG9uQ2xpY2tcbiAgICovXG4gIHB1YmxpYyB3aXRoQ2xpY2tIYW5kbGVyID0gKG9uQ2xpY2s6IGFueSkgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMub25DbGljayA9IG9uQ2xpY2s7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmeSBjb2x1bW4gY29udGVudCBhbGlnbm1lbnQgOiBib3RoIGhlYWRlciBhbmQgY2VsbHNcbiAgICogQHBhcmFtIGFsaWduXG4gICAqL1xuICBwdWJsaWMgd2l0aEFsaWduID0gKGFsaWduOiBzdHJpbmcpIDogQ29sdW1uID0+IHtcbiAgICB0aGlzLmFsaWduID0gYWxpZ247XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmeSBIZWFkZXIgZm9ybWF0dGVyIHRvIGN1c3RvbWl6ZSBhbGlnbm1lbnRzIG9yIGRpc3BsYXkgb2YgY29sdW1uIGhlYWRlclxuICAgKiBSZWZlcmVuY2U6IGh0dHBzOi8vcmVhY3QtYm9vdHN0cmFwLXRhYmxlLmdpdGh1Yi5pby9yZWFjdC1ib290c3RyYXAtdGFibGUyL2RvY3MvY29sdW1uLXByb3BzLmh0bWwjY29sdW1uaGVhZGVyZm9ybWF0dGVyLWZ1bmN0aW9uXG4gICAqIEBwYXJhbSBoZWFkZXJGb3JtYXR0ZXJcbiAgICovXG4gIHB1YmxpYyB3aXRoSGVhZGVyRm9ybWF0dGVyID0gKGhlYWRlckZvcm1hdHRlcjogYW55KSA6IENvbHVtbiA9PiB7XG4gICAgdGhpcy5oZWFkZXJGb3JtYXR0ZXIgPSBoZWFkZXJGb3JtYXR0ZXI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogU3BlY2lmeSBjdXN0b20gY29sdW1uIGhlYWRlciBjbGFzc1xuICAgKiBAcGFyYW0gaGVhZGVyQ2xhc3NcbiAgICovXG4gIHB1YmxpYyB3aXRoSGVhZGVyQ2xhc3MgPSAoaGVhZGVyQ2xhc3M6IGFueSkgOiBDb2x1bW4gPT4ge1xuICAgIHRoaXMuaGVhZGVyQ2xhc3MgPSBoZWFkZXJDbGFzcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTcGVjaWZ5IGN1c3RvbSBmaWx0ZXIgY29uZmlndXJhdGlvbiBmb3IgdHlwZXMgY29sdW1uXG4gICAqIFJFRkVSRU5DRSA6IGh0dHBzOi8vcmVhY3QtYm9vdHN0cmFwLXRhYmxlLmdpdGh1Yi5pby9yZWFjdC1ib290c3RyYXAtdGFibGUyL2RvY3MvZmlsdGVyLXByb3BzLmh0bWxcbiAgICogQHBhcmFtIGZpbHRlckNvbmZpZ1xuICAgKi9cbiAgcHVibGljIHdpdGhGaWx0ZXJDb25maWcgPSAoZmlsdGVyQ29uZmlnOiBhbnkpIDogQ29sdW1uID0+IHtcbiAgICB0aGlzLmZpbHRlckNvbmZpZyA9IGZpbHRlckNvbmZpZztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTcGVjaWZ5IHNlYXJjaCBLZXkgdG8gYmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBjb2x1bW5cbiAgICogTk9URSA6IFNwZWNpZnkgaWYgdGhlIHRhYmxlIGlzIHNlYXJjaGFibGUgYW5kIGNvbHVtbiBrZXkgaXMgbm90IHRoZSBzYW1lIGFzIHNlYXJjaCBrZXlcbiAgICogQHBhcmFtIHNlYXJjaEtleVxuICAgKi9cbiAgcHVibGljIHdpdGhTZWFyY2hLZXkgPSAoc2VhcmNoS2V5OiBzdHJpbmcpIDogQ29sdW1uID0+IHtcbiAgICB0aGlzLnNlYXJjaEtleSA9IHNlYXJjaEtleTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBmaWx0ZXIgZm9yIGNvbHVtbiB0eXBlXG4gICAqL1xuICBwdWJsaWMgZ2V0RmlsdGVyRm9yVHlwZSA9ICgpID0+IHtcbiAgICBpZiAodGhpcy50eXBlID09PSBDb2x1bW4uQ09MVU1OX1RZUEVTLlRFWFQpIHtcbiAgICAgIHJldHVybiB0ZXh0RmlsdGVyKHRoaXMuZmlsdGVyQ29uZmlnKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gQ29sdW1uLkNPTFVNTl9UWVBFUy5OVU1CRVIpIHtcbiAgICAgIHJldHVybiBudW1iZXJGaWx0ZXIodGhpcy5maWx0ZXJDb25maWcpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50eXBlID09PSBDb2x1bW4uQ09MVU1OX1RZUEVTLkRBVEUpIHtcbiAgICAgIHJldHVybiBkYXRlRmlsdGVyKHRoaXMuZmlsdGVyQ29uZmlnKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gQ29sdW1uLkNPTFVNTl9UWVBFUy5TRUxFQ1QpIHtcbiAgICAgIHJldHVybiBzZWxlY3RGaWx0ZXIodGhpcy5maWx0ZXJDb25maWcpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2Zvcm0gQ29sdW1uIHRvIGJvb3RzdHJhcCBjb2x1bW4gcHJvcHNcbiAgICovXG4gIHB1YmxpYyBjb252ZXJ0VG9Cb290c3RyYXBUYWJsZUNvbHVtbiA9ICgpOiBJQm9vdHN0cmFwQ29sdW1uID0+IHtcbiAgICBsZXQgZGVmYXVsdENvbHVtbiA9IHtcbiAgICAgIGFsaWduOiB0aGlzLmFsaWduLFxuICAgICAgY2xhc3NlczogdGhpcy5yb3dDbGFzcyxcbiAgICAgIGNzdkV4cG9ydDogIXRoaXMuaXNIaWRkZW4sXG4gICAgICBkYXRhRmllbGQ6IHRoaXMua2V5LFxuICAgICAgZXZlbnRzOiB7XG4gICAgICAgIG9uQ2xpY2s6IHRoaXMub25DbGlja1xuICAgICAgfSxcbiAgICAgIGZvcm1hdEV4dHJhRGF0YTogdGhpcy51bml0LFxuICAgICAgZm9ybWF0dGVyOiB0aGlzLmNlbGxGb3JtYXR0ZXIsXG4gICAgICBoZWFkZXJBbGlnbjogdGhpcy5hbGlnbixcbiAgICAgIGhlYWRlckNsYXNzZXM6IHRoaXMuaGVhZGVyQ2xhc3MsXG4gICAgICBoZWFkZXJFdmVudHM6IHtcbiAgICAgICAgb25DbGljazogdGhpcy5vbkNsaWNrXG4gICAgICB9LFxuICAgICAgaGVhZGVyRm9ybWF0dGVyOiB0aGlzLmhlYWRlckZvcm1hdHRlcixcbiAgICAgIGhpZGRlbjogdGhpcy5pc0hpZGRlbixcbiAgICAgIGlzRHVtbXlGaWVsZDogdGhpcy5pc0FjdGlvbkNvbHVtbixcbiAgICAgIHNlYXJjaEtleTogdGhpcy5zZWFyY2hLZXksXG4gICAgICBzb3J0OiB0aGlzLnNvcnRhYmxlLFxuICAgICAgdGV4dDogdGhpcy5sYWJlbCxcbiAgICAgIHR5cGU6IHRoaXMudHlwZVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5pc0ZpbHRlcmFibGUgJiYgdGhpcy50eXBlICE9PSBDb2x1bW4uQ09MVU1OX1RZUEVTLk5PTkUpIHtcbiAgICAgIGRlZmF1bHRDb2x1bW4gPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Q29sdW1uLCB7XG4gICAgICAgIGZpbHRlcjogdGhpcy5nZXRGaWx0ZXJGb3JUeXBlKClcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBkZWZhdWx0Q29sdW1uO1xuICB9XG59XG4iXX0=